# QUICK REFERENCE: Excel Column Mapping

## Visual Layout of Flow Sheet

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  COL A   â”‚  COL B      â”‚  COL C           â”‚  COL D           â”‚  COL E           â”‚  COL F    â”‚
â”‚          â”‚             â”‚                  â”‚                  â”‚                  â”‚           â”‚
â”‚  Index:  â”‚  Index: 1   â”‚  Index: 2        â”‚  Index: 3        â”‚  Index: 4        â”‚  Index: 5 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                ROW 1 (Index 0)                                   â”‚
â”‚          â”‚             â”‚  SYSTEM PROMPT   â”‚                  â”‚                  â”‚           â”‚
â”‚          â”‚             â”‚  (Optional)      â”‚                  â”‚                  â”‚           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                       INTERACTION 1 STARTS (4 rows)                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  1       â”‚  Bheem,     â”‚  "Yes Sir..."    â”‚  "Maybe..."      â”‚  "No..."         â”‚  "Tip"    â”‚
â”‚          â”‚  Satyam     â”‚  (Player Choice) â”‚  (Player Choice) â”‚  (Player Choice) â”‚  (Tips)   â”‚
â”‚          â”‚  (CHARS)    â”‚                  â”‚                  â”‚                  â”‚           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚          â”‚ competency  â”‚  Communication:5 â”‚  Problem:3       â”‚  Communication:2 â”‚           â”‚
â”‚          â”‚  (label)    â”‚  Teamwork:3      â”‚  Communication:4 â”‚  Problem:5       â”‚           â”‚
â”‚          â”‚             â”‚  (COMPETENCIES)  â”‚  (COMPETENCIES)  â”‚  (COMPETENCIES)  â”‚           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚          â”‚  other      â”‚  "Bheem: Good!   â”‚  "Please..."     â”‚  "That's not..." â”‚           â”‚
â”‚          â”‚  (label)    â”‚   Satyam: Yes"   â”‚  (COMP RESPONSE) â”‚  (COMP RESPONSE) â”‚           â”‚
â”‚          â”‚             â”‚  (COMP RESPONSE) â”‚                  â”‚                  â”‚           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚          â”‚             â”‚                  â”‚                  â”‚                  â”‚           â”‚
â”‚          â”‚             â”‚    (BLANK ROW)   â”‚                  â”‚                  â”‚           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                       INTERACTION 2 STARTS (4 rows)                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  2       â”‚  Kalyani    â”‚  "Everything..." â”‚  "We have..."    â”‚  "Need more..."  â”‚  "Tip 2"  â”‚
â”‚          â”‚  (CHAR)     â”‚  (Player Choice) â”‚  (Player Choice) â”‚  (Player Choice) â”‚  (Tips)   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚          â”‚ competency  â”‚  Communication:4 â”‚  Problem:5       â”‚  Teamwork:3      â”‚           â”‚
â”‚          â”‚             â”‚  Problem:2       â”‚                  â”‚                  â”‚           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚          â”‚  other      â”‚  "Kalyani:       â”‚  "Let me help"   â”‚  "We'll          â”‚           â”‚
â”‚          â”‚             â”‚   Excellent!"    â”‚                  â”‚   allocate..."   â”‚           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚          â”‚             â”‚                  â”‚                  â”‚                  â”‚           â”‚
â”‚          â”‚             â”‚    (BLANK ROW)   â”‚                  â”‚                  â”‚           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Code Access Pattern

```python
# reader/excel.py - Line 156-195

current_index = data.loc[data[0] == interaction_number].index[0]

# Column A (index 0): Interaction number
interaction_num = data.iloc[current_index, 0]

# Column B (index 1): Character name(s) âœ… NEWLY ADDED FOR TEAM ROLEPLAY
character = data.iloc[current_index, 1]  

# Column F (index 5): Tips (optional)
tips = data.iloc[current_index, 5]

# Columns C-E (indices 2-4): Player responses
player_responses = data.iloc[current_index, 2:].tolist()[:3]

# Next row, Columns C-E: Competency mappings
competencies = data.iloc[current_index+1, 2:].tolist()[:3]

# Next row, Columns C-E: Computer responses
computer_responses = data.iloc[current_index+2, 2:].tolist()[:3]
```

## What Changed for Team Roleplay Support

### BEFORE (Old Code):
```python
# Column B was ignored or used for generic "situation" label
```

### AFTER (New Code):
```python
# Column B now reads character name(s) for voice generation
character = self.data.iloc[current_index, 1]  # â† Line 170

# Supports multiple formats:
# - "Bheem"                â†’ Single character
# - "Bheem, Satyam"        â†’ Multiple characters (comma)
# - "Bheem|Satyam"         â†’ Multiple characters (pipe)
# - "Bheem and Satyam"     â†’ Multiple characters (and)

# Parsed into array for future multi-voice support
characters = [c.strip() for c in character.split(',')]
```

## Validation Alignment

The validator (`app/enhanced_excel_validator.py`) checks:

âœ… **Line 319**: Reads Column B for scenario/character (optional)
```python
scenario_cell = df.iloc[start_row, 1]  # Column B
```

âœ… **Line 329-342**: Validates Columns C-E (player responses)
```python
for col_idx in range(2, min(5, df.shape[1])):  # Columns C, D, E
    player_cell = df.iloc[start_row, col_idx]
```

âœ… **Line 349**: Reads Column F (tips - optional)
```python
tips_cell = df.iloc[start_row, 5]  # Column F
```

âœ… **Line 371-389**: Validates competency row (next row, Columns C-E)
âœ… **Line 406-424**: Validates computer response row (next row + 1, Columns C-E)

## Summary

**ALL FILES ARE CORRECTLY ALIGNED** âœ…

1. **Excel Structure**: Column B is for character names (newly documented)
2. **Reader Code**: Correctly reads Column B (index 1) for characters
3. **Validator Code**: Validates Column B exists (optional field)
4. **Voice Generation**: Uses character from Column B to determine voice gender
5. **Template**: Passes character info to audio generation

**Your Excel format is:**
```
A: Interaction#  B: Character(s)  C: Choice 1  D: Choice 2  E: Choice 3  F: Tips
```

This structure is consistent throughout all code files! ğŸ¯
